<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Explorable Image Progres</title>

    <!-- MyCSS -->
    <link href='assets/css/my.css' rel='stylesheet'>
    <!-- Bootstrap -->
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Ekko Lightbox -->
    <link href='assets/bootstrap/css/ekko-lightbox.css' rel='stylesheet'>
    <link href='assets/bootstrap/css/dark.css' rel='stylesheet'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    <!-- Header -->
    <div class='myheader'>
      <div class='container'>
        <h1>Explorable Image</h1>
      </div>
    </div>

    <div class='content-section'>
      <div class='container'>

        <!-- Milestones -->
        <div class='summary'>

          <h2>Milestones <small>LDAV 5/14</small></h2>
          <!-- The 3 Major Components -->
          <div class='component'>
            <h4>Explorable Image Renderer</h4>
            <ul>
              <li style='text-decoration:line-through'>Generate explorable image with Hongfeng's parallel renderer.</li>
              <li>Implement Anna's version</li>
              <ul>
                <li>Relighting using depth proxy images</li>
                <li>Attenuation clustering and model learning</li>
              </ul>
              <li>Parallel reading the data from Dr Ono's simulation.</li>
            </ul>
          </div>
          <div class='component'>
            <h4>Yang's Feature Tracking</h4>
            <ul>
              <li style='text-decoration:line-through'>Yang needs the depth proxy images.</li>
              <li>Be able to extract image from a single explorable image.</li>
              <li>Track features over time.</li>
            </ul>
          </div>
          <div class='component'>
            <h4>Explorable Image Viewer</h4>
            <ul>
              <li style='text-decoration:line-through'>Incorporate depth proxy images to provide lighting.</li>
              <li>Provide interface to specify parameters for the parallel renderer.</li>
              <li>Provide interface to select feature from explorable image.</li>
              <li>Interface design (timeline?)</li>
            </ul>
          </div>
          <div class='component'>
            <h4>Write the Paper</h4>
            <ul>
              <li>We need at least a proof of concept demo before we can write the paper.</li>
            </ul>
          </div>

        </div>

        <!-- Updates -->
        <div class='updates'>

          <h2>Progress</h2>

          <!-- 13 -->
          <div class='entry'>
            <!-- title -->
            <h3>Boundary Artifacts Conquered</h3>
            <!-- images -->
            <div class='row gallery-wrapper'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/boundary_fixed.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/boundary_fixed.png'>
                </a>
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/boundary_wo_early_ray_termination.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/boundary_wo_early_ray_termination.png'>
                </a>
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/boundary_with_early_ray_termination.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/boundary_with_early_ray_termination.png'>
                </a>
              </div>
            </div>
            <!-- text -->
            <p>I found the bug. It is a small but serious bug in the attenuation calculation. It was using</p>
            <pre>accumulate_alpha += current_alpha</pre>
            <p>and then clamp the accumulate_alpha to [0, 1], which is wrong but the image generated looked ok. After changing it to</p>
            <pre>accumulate_alpha += (1.0 - accumulate_alpha) * current_alpha</pre>
            <p>the boundary artifacts disappeared.</p>
            <p>Image 1 is using the correct equation. Image 2 is using the wrong equation but not clamp to [0, 1]. Image 3 is using the wrong equation and clamp to [0, 1].</p>
          </div>

          <!-- 12 -->
          <div class='entry'>
            <!-- title -->
            <h3>Found Some Artifacts at Boundary <small>May 1st</small</h3>
            <!-- images -->
            <div class='row gallery-wrapper'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/boundary_png1.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/boundary_png1.png'>
                </a>
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/boundary_raf1.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/boundary_raf1.png'>
                </a>
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/boundary_raf2.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/boundary_raf2.png'>
                </a>
              </div>
            </div>
            <!-- text -->
            <p>I was trying to clean the codes and make it run in a cluster (thehead). When I make it to run in parallel, I found some artifacts at the process boundaries. As shown in image 2 and image 3.</p>
            <ul>
              <li>It seems that these artifacts only appears when we are generating RAF formats because image 1 (a static image) does not have the artifacts.</li>
              <li>There is a function named "block_exchange_boundary()" in Hongfeng's codes. It is used to exchange boundary volume data and it fixed the boundary artifacts when we are generating static images. However, the situation is different when we are generating RAF images. If we enable "block_exchange_boundary()", it generates image 2. If we do not enable "block_exchange_boundary()", it generates image 3. That is, it fixes some of the artifacts.</li>
            </ul>
          </div>

          <!-- 11 -->
          <div class='entry'>
            <!-- title -->
            <h3>Smoother Supernova Video <small>April 28</small></h3>
            <!-- video -->
            <div class='row'>
              <video class='col-xs-12 col-sm-6' controls>
                <source src='contents/videos/supernova_2nd.mp4' type='video/mp4'/>
                <source src='contents/videos/supernova_2nd.webm' type='video/webm'/>
                <source src='contents/videos/supernova_2nd.ogv' type='video/ogg'/>
                Your browser does not support the video tag.
              </video>
            </div>
            <!-- text -->
            <p>There are two jumps in the video:</p>
            <ul>
              <li>At 1/4 of the video: That is caused by 2 missing frames. I tried to smooth it out by editting the video. The video you are seeing now is the smoothed version.</li>
              <li>About 1/2 of the video, where the core of the supernova suddenly becomes solid. Two reasons: 1) The data actually is moving very fast at that moment. Better temporal resolution? 2) My guess is a huge chunk of data crossed boundary of the intensity bins at that moment, which turns a lot of yellow into green.</li>
            </ul>
          </div>

          <!-- 10 -->
          <div class='entry'>
            <!-- title -->
            <h3>The First Supernova Video <small>April 27</small></h3>
            <!-- video -->
            <div class='row'>
              <video class='col-xs-12 col-sm-6' controls>
                <source src='contents/videos/supernova_1st.mp4' type='video/mp4'/>
                <source src='contents/videos/supernova_1st.webm' type='video/webm'/>
                <source src='contents/videos/supernova_1st.ogv' type='video/ogg'/>
                Your browser does not support the video tag.
              </video>
            </div>
            <!-- text -->
            <p>Combined the images of supernova into a video. There are some jumps in the video. Two reasons: 1) The supernova dataset is missing 2 timesteps of data (1461 and 1462). 2) There were 4 timesteps that were unable to render for unknown reason. (1466, 1467, 1564 and 1565).</p>
          </div>

          <!-- 9 -->
          <div class='entry'>
            <!-- title -->
            <h3>Fixed Normals <small>April 27</small></h3>
            <!-- images -->
            <div class='row'>
              <a href='contents/images/supernova_fixed_normal_1403.png' class='col-sm-6 col-md-4' data-gallery='multiimages' data-toggle='lightbox'>
                <div class='thumbnail'>
                  <img src='contents/images/supernova_fixed_normal_1403.png' class='img-responsive'>
                </div>
              </a>
              <a href='contents/images/supernova_fixed_normal_1440.png' class='col-sm-6 col-md-4' data-gallery='multiimages' data-toggle='lightbox'>
                <div class='thumbnail'>
                  <img src='contents/images/supernova_fixed_normal_1440.png'>
                </div>
              </a>
              <a href='contents/images/supernova_fixed_normal_1470.png' class='col-sm-6 col-md-4' data-gallery='multiimages' data-toggle='lightbox'>
                <div class='thumbnail'>
                  <img src='contents/images/supernova_fixed_normal_1470.png'>
                </div>
              </a>
              <a href='contents/images/supernova_fixed_normal_1540.png' class='col-sm-6 col-md-4' data-gallery='multiimages' data-toggle='lightbox'>
                <div class='thumbnail'>
                  <img src='contents/images/supernova_fixed_normal_1540.png'>
                </div>
              </a>
              <a href='contents/images/supernova_fixed_normal_1580.png' class='col-sm-6 col-md-4' data-gallery='multiimages' data-toggle='lightbox'>
                <div class='thumbnail'>
                  <img src='contents/images/supernova_fixed_normal_1580.png'>
                </div>
              </a>
            </div>
            <!-- text -->
            <p>I fixed an issue in the normal estimation process based on Bob's input. Images from left to right are from timestep 1403, 1440, 1470, 1540 and 1580. A few things:</p>
            <ul>
              <li>There are still visible artifacts (the black lines). Those are where the depth layers disjoint. We might be able to interpolate a more accurate depth value based on neighbor bins, but I don't think I can make the fix in time.</li>
              <li>It was my mistake that used a viewport that only captures the first timestep entirely. It seems like the supernova moves around significantly.</li>
              <li>Using one transfer function is not enough for the whole time span of this supernova dataset. When the transfer function looks good in 1580, it doesn't look interesting in 1403. That actually makes it more interesting because we can demonstrate how explorable images can deal with this problem.</li>
            </ul>
          </div>

          <!-- 8 -->
          <div class='entry'>
            <!-- title -->
            <h3>Need Input for Transfer Function <small>April 26</small></h3>
            <!-- images -->
            <div class='row'>
              <div class='col-sm-6 col-md-6'>
                <a href='contents/images/supernova_transferfunction.png' class='thumbnail' data-toggle='lightbox'>
                  <img src='contents/images/supernova_transferfunction.png'>
                </a>
              </div>
            </div>
            <!-- text -->
            <p>This image is generated using the transfer function on the left, also I hard coded it to cutaway the front part. There are artifacts which I do not understand why/how. I assume they are artifacts from the viewing stage. Generating such an image is time consuming, generating a image sequence can take hours, so we have 1 chance (tonight) to generate the video.</p>
            <p>As long as the view angle and the opacity map is good enougth, we can change the colors later. And I hope I can fix the artifacts tomorrow.</p>
            <p>Bob, do you have any idea where these artifacts might come from?</p>
          </div>

          <!-- 7 -->
          <div class='entry'>
            <!-- title -->
            <h3>Video from Dr. Ono's Simulation Data <small>April 26</small></h3>
            <!-- video -->
            <div class='row'>
              <video class='col-xs-12 col-sm-6' controls>
                <source src='contents/videos/jet_oblique_video.mp4' type='video/mp4'/>
                <source src='contents/videos/jet_oblique_video.webm' type='video/webm'/>
                <source src='contents/videos/jet_oblique_video.ogv' type='video/ogg'/>
                Your browser does not support the video tag.
              </video>
            </div>
            <!-- text -->
            <p>This is actually generated using ParaView. It is intended to be used by Yang to make a proof of concept video for feature tracking because making the actual feature tracking to work is time consuming and we don't have enough time at this stage.
          </div>

          <!-- 6 -->
          <div class='entry'>
            <!-- title -->
            <h3>Lighting with Depth Proxy <small>April 25</small></h3>
            <!-- images -->
            <div class='row gallery-wrapper'>
              <div class='col-sm-6 col-md-6'>
                <a href='contents/images/lighting1.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/lighting1.png'>
                </a> 
              </div>
              <div class='col-sm-6 col-md-6'>
                <a href='contents/images/lighting2.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/lighting2.png'>
                </a> 
              </div>
            </div>
            <!-- text -->
            <p>From Bob:</p>
            <blockquote>
              <p>I've added Phong lighting to Chris's viewer (Actually I was done with that at about 9PM).</p>
              <p>What I've been experimenting with since then is: I don't understand the behavior I'm getting from the transfer function editor. I believe it's what Chris is complaining about with respect to the assumptions made within the structure of the RAFs. Color modulation works great, but opacity modulation is extremely finicky: If I even slightly raise the low intensity value opacity, the higher values are either completely hidden or oversaturate immediately. I confirmed that Chris's code conforms to the description in the paper, so there must be something Anna and the others felt to be trivial that's necessary to fix it. Chris: I think we can fix this issue now that we have the depths, by sorting the bins by depth before rendering. I'm tired for now, but I'll test my hypothesis tomorrow. My implementation is on our dropbox share.</p>
              <p>The first attached image is just a quick demonstration with opacity disabled so that you can more clearly see the lighting changes. It's just the Phong model: The parameters are all configurable within the shader, and whenever we like we can expose them in the interface.</p>
              <p>The second attached image is the same except with opacity enabled. I recognize the quality is bad: as I said, I really had to play around a lot with the opacities to get a half-decent picture...this needs to be fixed, so hopefully my idea will work.</p>
            </blockquote>
          </div>

          <!-- 5 -->
          <div class='entry'>
            <!-- title -->
            <h3>Wrong Lighting <small>April 20</small></h3>
            <!-- images -->
            <div class='row'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z10.png' class='thumbnail' data-toggle='lightbox'>
                  <img src='contents/images/z10.png'>
                </a> 
              </div>
            </div>
            <!-- text -->
            <p>As Hongfeng recommended, I used amb_diff as attenuation in the ray attenuation function, which is mathematically incorrect. Because by using amb_diff, we actually revealed the bins that should be occluded.</p>
            <p>For example, we have slab A and slab B, where slab A is in front of slab B and slab A is fully opaque. If we are using alpha as attenuation, we will not be able to see slab B, which is correct, but if we use amb_diff as attenuation, we will be seeing slab B because slab A is no longer fully opaque.</p>
          </div>

          <!-- 4 -->
          <div class='entry'>
            <!-- title -->
            <h3>First Image from Dr. Ono's Simulation <small>April 18</small></h3>
            <!-- images -->
            <div class='row'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z9.png' class='thumbnail' data-toggle='lightbox'>
                  <img src='contents/images/z9.png'>
                </a> 
              </div>
            </div>
            <!-- text -->
            <p>This image is rendered from Dr. Ono's simulation output data. This is not genereated in situ, rather I used the output data that Yang generated in the past. And this is not generated in parallel because the data is not stored in a parallel way.</p>
          </div>

          <!-- 3 -->
          <div class='entry'>
            <!-- title -->
            <h3>Opacity Modulation <small>April 18</small></h3>
            <!-- images -->
            <div class='row gallery-wrapper'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z6.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z6.png'>
                </a> 
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z7.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z7.png'>
                </a>
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z8.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z8.png'>
                </a>
              </div>
            </div>
            <!-- text -->
            <p>Implemented opacity modulation as described in the paper. The 3 images are generated from a single explorable image.</p>
            <p>We can change the opacity map to reveal internal structures, from image 1 to image 2.</p>
            <p>They made a big assumption that a ray traverse from low intensity to high intensity. As a result, when we change the opacity value of a lower intensity bin, it affects the opacity of the higher intensity bins. In image 3, we lower the opacity value of some lower intensity bins, it amplifies the opacity values in the higher intensity bins, which makes them all white.</p>
          </div>

          <!-- 2 -->
          <div class='entry'>
            <!-- title -->
            <h3>Rendered with Smaller Step Size <small>April 18</small></h3>
            <!-- images -->
            <div class='row gallery-wrapper'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z3.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z3.png'>
                </a> 
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z4.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z4.png'>
                </a>
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z5.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z5.png'>
                </a>
              </div>
            </div>
            <!-- text -->
            <p>These images are rendered with a ray step size 0.5, which eliminates the ring artifacts. Of course we can change the colors. I tried to incorporate opacity change in the third image. This opacity change doesn't have opacity modulation. I am going to implement it next.</p>
          </div>

          <!-- 1 -->
          <div class='entry'>
            <!-- title -->
            <h3>First Images <small>April 17</small></h3>
            <!-- images -->
            <div class='row gallery-wrapper'>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z1.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z1.png'>
                </a> 
              </div>
              <div class='col-sm-6 col-md-4'>
                <a href='contents/images/z2.png' class='thumbnail' data-toggle='lightbox'
                   data-gallery='multiimages' data-parent='.gallery-wrapper'>
                  <img src='contents/images/z2.png'>
                </a>
              </div>
            </div>
            <!-- text -->
            <p>This is the first sets of explorable images generated using Hongfeng's codes. They are generated using a fairly big ray step size (2.0). That is why the ring like artifacts appear. I am using a big step size because it is slow since it is a software renderer. The two images demonstrate that we can change the colormap, but I still need to add the functonality in the viewer to be able to change the opaicty map.</p>
          </div>

        </div>

      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Ekko Lightbox -->
    <script src='assets/bootstrap/js/ekko-lightbox.js'></script>
    <!-- Ekko Lightbox Setup -->
    <script type="text/javascript">
      $(document).ready(function ($) {
        $(document).delegate('*[data-toggle="lightbox"]', 'click', function(event) {
          event.preventDefault();
          return $(this).ekkoLightbox();
        });
      });
    </script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>

  </body>
</html>